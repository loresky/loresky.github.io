+++
title= "定时删除文件"
date= "2018-06-12T17:13:23+08:00"
tags = []
featured_image = ""
description = ""
+++

``` go
package main

import (
	"fmt"
	"log"
	"os"
	"strconv"

	"github.com/BurntSushi/toml"
	"github.com/robfig/cron"
)

type config struct {
	Dirurl string `toml:"dirurl"`
}

var (
	Config config
)

func main() {

	// var a interface{}
	// var b int
	// a = 1
	// b = a.(int)
	// fmt.Println(a, b)
	// aa()

	// os.RemoveAll("/home/cat/goProjects/src/test/aa/aaa")

	if _, err := toml.DecodeFile("./conf.toml", &Config); err != nil {
		fmt.Println("config decode err:" + err.Error())
		return
	}
	fmt.Println(Config.Dirurl)

	// os.RemoveAll(Config.Dirurl)

	c := cron.New()
	spec := "0 0 1 * * ?"
	c.AddFunc(spec, func() {
		remoeDir()
	})
	c.Start()

	select {}
}
func remoeDir() {
	err := os.RemoveAll(Config.Dirurl)
	if err != nil {
		log.Println("err:", err)
	}
	log.Println("删除除目录:", Config.Dirurl)
}

func aa() {
	// var f *os.File

	fmt.Println("cron ===========")
	log.Println("cron runniasaasfasdfsd---ng:")
	i := 0
	c := cron.New()
	spec := "*/1 * * * * ?"
	c.AddFunc(spec, func() {
		i++
		// filename := "/home/cat/goProjects/src/test/aa/aaa/sss/text"
		filename := Config.Dirurl
		filename += strconv.Itoa(i)
		filename += ".txt"
		fmt.Println(filename)

		file3, error := os.Create(filename)
		if error != nil {
			fmt.Println(error)
		}
		fmt.Println(file3)
		file3.Close()

		// f, err1 = os.Create(filename) //创建文件
		// if error != nil {
		// 	fmt.Println(error)
		// }
		// fmt.Println(f)
	})
	// c.AddFunc("@every 1h1m", func() {
	// 	i++
	// 	log.Println("cron running:", i)
	// 	fmt.Println("cron running===:", i)
	// })
	c.Start()
	for {
		// log.Println("i:", i)
	}
}

```


name = "goweb_db"

dirurl= "/home/cat/goProjects/src/test/aa/vvvb"